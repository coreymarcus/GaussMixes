%Test of WTKF based on paper

clear
close all
clc

%define constants from paper
a = [1.3, 0.8, 1.0]';
t = 5:5:25;
x0 = [7.86, 8.74, 14.4, -0.08, 0.28, 0.07]';
Sigma0 = zeros(6);
Sigma0(4:6,4:6) = 0.01*eye(3);
Sigma0(1:3,1:3) = [5 5 1;
    5 11 4;
    1 4 2];
theta_i = zeros(6);
theta_i(1:3,1:3) = [2.9, 3.4, 1.0;
    3.4, 6.0, 3.2,;
    1.0, 3.2, 2.4];
theta_i(4:6,4:6) = 0.0025*eye(3);
q = [1 0 0 1 0.1 0 0.4 0.6 0.2;
    0 1 0 0 0 0 0.1 0.2 0.1;
    0 1 1 0.9 0.2 0.7 0.1 0.2 0;
    0.6 0 1 1 1 1 0 0.3 0;
    0.6 0.1 1 0.6 0.1 1 0.6 0.1 1;
    0.2 0.3 0.4 0.6 0.1 1 0.6 0.1 1;
    0.4 0.7 0.8 0.4 0.2 0.4 0.6 0.1 1;
    0.1 0.3 0.5 0.6 0.6 0.4 0.3 0.2 1;
    0.6 0.1 1 0.6 0.1 1 0.6 0.1 1];
Q_y = [3.01 1.32 1.08 2.12 1.67 1.35 0.72 1.02 1.58;
    1.32 1.04 0.13 0.73 0.74 0.40 0.14 0.18 0.72;
    1.08 0.13 3.39 2.86 2.40 2.04 1.98 1.81 2.39;
    2.12 0.73 2.86 4.58 3.15 2.27 1.43 2.23 3.22;
    1.67 0.74 2.40 3.15 3.79 3.05 1.26 1.49 3.77;
    1.35 0.40 2.04 2.27 3.05 3.03 1.16 1.33 2.99;
    0.72 0.14 1.98 1.43 1.26 1.16 1.70 1.17 1.21;
    1.02 0.18 1.81 2.23 1.49 1.33 1.17 1.36 1.50;
    1.58 0.72 2.39 3.22 3.77 2.99 1.21 1.50 3.78];

%measurements
y = zeros(9,5);
y(:,1) = [7.82 11.8 19.3 -8.4 -37 89.9 0.08 -33 121]';
y(:,2) = [14.2 15.2 21.8 6.97 -132 128 24.8 -37.5 157]';
y(:,3) = [25.523 21.69 26.15 41.537 -262.67 172.63 50.492 -41.427 195.99]';
y(:,4) = [28.27 24.36 34.82 90.96 -432 228.6 80.97 -44.3 236.9]';
y(:,5) = [32.707 27.548 35.058 149.51 -650.16 287.02 106 -50.29 269.17]';

%initialize storage


%begin algorithm
for ii = 1:5
    
    
end

